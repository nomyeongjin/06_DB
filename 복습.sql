-- TB_GRADE 테이블 생성
CREATE TABLE TB_GRADE ( GRADE_CODE VARCHAR2(10) PRIMARY KEY, GRADE_NAME VARCHAR2(20) );

-- TB_AREA 테이블 생성
CREATE TABLE TB_AREA ( AREA_CODE VARCHAR2(10) PRIMARY KEY, AREA_NAME VARCHAR2(20) );

-- TB_MEMBER 테이블 생성
CREATE TABLE TB_MEMBER ( MEMBERID VARCHAR2(20) PRIMARY KEY, MEMBERPWD VARCHAR2(20), MEMBER_NAME VARCHAR2(50), GRADE VARCHAR2(10), AREA_CODE VARCHAR2(10), FOREIGN KEY (GRADE) REFERENCES TB_GRADE(GRADE_CODE), FOREIGN KEY (AREA_CODE) REFERENCES TB_AREA(AREA_CODE) );

-- 데이터 삽입 --TB_GRADE 테이블 데이터 삽입
INSERT INTO TB_GRADE (GRADE_CODE, GRADE_NAME) VALUES ('10', '일반회원');
INSERT INTO TB_GRADE (GRADE_CODE, GRADE_NAME) VALUES ('20', '우수회원');
INSERT INTO TB_GRADE (GRADE_CODE, GRADE_NAME) VALUES ('30', '특별회원');

-- TB_AREA 테이블 데이터 삽입
INSERT INTO TB_AREA (AREA_CODE, AREA_NAME) VALUES ('02', '서울');
INSERT INTO TB_AREA (AREA_CODE, AREA_NAME) VALUES ('031', '경기');
INSERT INTO TB_AREA (AREA_CODE, AREA_NAME) VALUES ('032', '인천');

-- TB_MEMBER 테이블 데이터 삽입
INSERT INTO TB_MEMBER (MEMBERID, MEMBERPWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('hong01', 'pass01', '홍길동', '10', '02');
INSERT INTO TB_MEMBER (MEMBERID, MEMBERPWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('leess99', 'pass02', '이순신', '10', '032');
INSERT INTO TB_MEMBER (MEMBERID, MEMBERPWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('SS50000', 'pass03', '신사임당', '30', '031');
INSERT INTO TB_MEMBER (MEMBERID, MEMBERPWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('1u93', 'pass04', '아이유', '30', '02');
INSERT INTO TB_MEMBER (MEMBERID, MEMBERPWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('pcs1234', 'pass05', '박철수', '20', '031');
INSERT INTO TB_MEMBER (MEMBERID, MEMBERPWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('you_is', 'pass06', '유재석', '10', '02');
INSERT INTO TB_MEMBER (MEMBERID, MEMBERPWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('kyh9876', 'pass07', '김영희', '20', '031');

-------------------------------------------------------------------------------------------------

-- 모든 회원의 이름과 등급을 조회하기
SELECT MEMBER_NAME, GRADE_NAME 
FROM TB_MEMBER M
JOIN TB_GRADE G ON(M.GRADE=G.GRADE_CODE);

--등급이 일반회원인 회원을 조회
SELECT *
FROM TB_MEMBER
WHERE GRADE ='10';

-- 경기지역에 거주하는 회원의 아이디와 이름 조회하기
SELECT MEMBERID , MEMBER_NAME , AREA_CODE 
FROM TB_MEMBER
JOIN TB_AREA USING(AREA_CODE)
WHERE AREA_NAME ='경기';

-- 등급이 우수회원이고 이름에 '이'가 포함된 회원의 이름을 조회하기
SELECT MEMBER_NAME 
FROM TB_MEMBER
WHERE MEMBER_NAME LIKE '%이%' AND GRADE = '20';

SELECT MEMBER_NAME 
FROM TB_MEMBER
WHERE GRADE ='10'
ORDER BY MEMBER_NAME ;


SELECT MEMBERID , MEMBER_NAME 
FROM TB_MEMBER
WHERE GRADE = '30' AND MEMBER_NAME LIKE '%신%';

SELECT MEMBER_NAME 
FROM TB_MEMBER
JOIN TB_AREA USING(AREA_CODE)
JOIN TB_GRADE ON(GRADE=GRADE_CODE)
WHERE AREA_NAME = '서울' AND GRADE_NAME = '일반회원';

-- 특정 지역의 회원 수 조회
SELECT AREA_NAME,COUNT(*)
FROM TB_MEMBER
JOIN TB_AREA USING(AREA_CODE)
GROUP BY AREA_NAME;

-- 특정 회원(홍길동)의 지역 정보 조회
SELECT MEMBER_NAME, AREA_NAME
FROM TB_MEMBER
JOIN TB_AREA USING(AREA_CODE)
WHERE MEMBER_NAME='홍길동';

-- 일반 회원과 우수 회원 수 비교
SELECT GRADE_NAME ,COUNT(*) 
FROM TB_MEMBER
JOIN TB_GRADE ON(GRADE_CODE=GRADE)
GROUP BY GRADE_NAME 
HAVING GRADE_NAME ='일반회원' OR GRADE_NAME = '우수회원';

-- SS50000 회원의 등급과 이름 조회
SELECT GRADE_NAME, MEMBER_NAME 
FROM TB_MEMBER
JOIN TB_GRADE ON(GRADE_CODE=GRADE)
WHERE MEMBERID ='SS50000';
